= Configuración de Red en Linux (Temporal y Persistente)
:toc:
:toclevels: 3
:sectnums:

== Configuración Temporal de Red (No Persistente)

Las configuraciones temporales no sobreviven a un reinicio del sistema. Se utilizan habitualmente para pruebas, diagnósticos o cambios puntuales.

[source,bash]
sudo ip addr del 192.168.1.4 dev enp0s3

Elimina la dirección IP indicada de la interfaz especificada.

[source,bash]
sudo ip route add default via 192.168.1.1

Añade una ruta por defecto, estableciendo la puerta de enlace.

[source]
nameserver 8.8.8.8
nameserver 8.8.4.4

Define servidores DNS.
Nota: estas líneas deben añadirse al archivo /etc/resolv.conf, aunque este fichero suele ser sobrescrito por DHCP o NetworkManager.

== Configuración Persistente en Debian (ifupdown)

En sistemas Debian clásicos, la configuración persistente de red se realiza editando el archivo:

[source]
/etc/network/interfaces

Este método requiere que el sistema utilice el paquete:

[source,bash]
ifupdown

y que NetworkManager esté deshabilitado.

== Configuración Dinámica (DHCP)

La dirección IP y demás parámetros se obtienen automáticamente de un servidor DHCP.

[source]
auto enp0s3
iface enp0s3 inet dhcp

Características:

IP no persistente.

Ideal para redes domésticas o entornos virtualizados (NAT).

Menor control, mayor automatización.

== Configuración Estática

La dirección IP se define manualmente y permanece fija.

[source]
auto enp0s3
iface enp0s3 inet static
address 192.168.4.5
netmask 255.255.255.0
gateway 192.168.4.1

Características:

IP persistente.

Recomendado para servidores.

Mayor control y previsibilidad.

== Aplicación de Cambios de Red

Para que la configuración tenga efecto, es necesario asegurarse de que NetworkManager no interfiera:

[source,bash]
sudo systemctl stop NetworkManager
sudo systemctl disable NetworkManager

Opciones para aplicar los cambios:

Reiniciar el sistema.

Reiniciar la interfaz manualmente:

[source,bash]
sudo ifdown enp0s3
sudo ifup enp0s3

== Herramientas de Diagnóstico de Red

=== Comando dig

El comando Domain Information Groper se utiliza para consultas DNS.

[source,bash]
dig ejemplo.com

Permite verificar:

Resolución de nombres.

Servidores DNS utilizados.

Registros DNS (A, AAAA, MX, NS, etc.).

=== Cliente DHCP (dhclient)

Para ver en tiempo real la información proporcionada por el servidor DHCP en el cliente:

[source,bash]
dhclient -d -nw enp0s3

Muestra:

IP asignada.

Máscara de subred.

Gateway.

Servidores DNS.

=== Servidor DHCP (leases)

En el servidor DHCP, las concesiones otorgadas a los clientes se almacenan en:

[source,bash]
cat /var/lib/dhcp/dhcpd.leases

Este archivo contiene:

IP asignada.

Dirección MAC del cliente.

Tiempo de concesión.

Estado de la lease.

